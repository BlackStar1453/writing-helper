# Premiumå¹´ä»˜åŠŸèƒ½å®ç°

## åŠŸèƒ½æ¦‚è¿°

ä¸ºPremiumè®¡åˆ’æ·»åŠ äº†å¹´ä»˜é€‰é¡¹ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©å¹´ä»˜å¹¶äº«å—20%çš„æŠ˜æ‰£ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½
- **å¹´ä»˜é€‰é¡¹**ï¼šä»…å¯¹Premiumè®¡åˆ’æ˜¾ç¤º
- **20%æŠ˜æ‰£**ï¼šå¹´ä»˜ç”¨æˆ·äº«å—20%ä¼˜æƒ 
- **åŒæ”¯ä»˜æ–¹å¼**ï¼šæ”¯æŒStripeå’ŒXorpayå¹´ä»˜
- **æ™ºèƒ½ä»·æ ¼è®¡ç®—**ï¼šè‡ªåŠ¨è®¡ç®—å¹´ä»˜ä»·æ ¼å’ŒèŠ‚çœé‡‘é¢

### ğŸ¨ UIè®¾è®¡
- **Switchå¼€å…³**ï¼šä½¿ç”¨ç°ä»£åŒ–çš„å¼€å…³ç»„ä»¶
- **æ¸å˜èƒŒæ™¯**ï¼šæ©™è‰²æ¸å˜èƒŒæ™¯çªå‡ºå¹´ä»˜é€‰é¡¹
- **èŠ‚çœæç¤º**ï¼šæ˜¾ç¤ºå…·ä½“èŠ‚çœé‡‘é¢
- **ç«ç„°å›¾æ ‡**ï¼šå¢åŠ è§†è§‰å¸å¼•åŠ›

## å®ç°ç»†èŠ‚

### å‰ç«¯ç»„ä»¶æ›´æ–°

#### 1. PaymentMethodSelectorç»„ä»¶
- æ·»åŠ å¹´ä»˜çŠ¶æ€ç®¡ç†ï¼š`isAnnualBilling`
- æ™ºèƒ½ä»·æ ¼è®¡ç®—é€»è¾‘
- å¹´ä»˜UIç»„ä»¶

#### 2. ä»·æ ¼è®¡ç®—é€»è¾‘
```typescript
// å¹´ä»˜ä»·æ ¼è®¡ç®—
if (isPremiumPlan && isAnnual && annualDiscount > 0) {
  const monthlyPrice = finalPrice;
  const yearlyPrice = monthlyPrice * 12;
  const yearlyDiscountedPrice = yearlyPrice * 0.8; // 20%æŠ˜æ‰£
  const yearlyDiscountAmount = yearlyPrice - yearlyDiscountedPrice;
  
  return {
    originalPrice: yearlyPrice,
    price: yearlyDiscountedPrice,
    discountAmount: yearlyDiscountAmount,
    isAnnual: true,
    monthlyEquivalent: yearlyDiscountedPrice / 12,
    annualSavings: yearlyDiscountAmount,
  };
}
```

### åç«¯æ”¯ä»˜é€»è¾‘

#### 1. Stripeé›†æˆ
- ä¿®æ”¹`createCheckoutSession`æ”¯æŒå¹´ä»˜å‚æ•°
- è‡ªå®šä¹‰ä»·æ ¼åˆ›å»ºï¼ˆå¹´ä»˜é—´éš”ï¼‰
- å…ƒæ•°æ®è®°å½•å¹´ä»˜ä¿¡æ¯

#### 2. Xorpayé›†æˆ
- ä¿®æ”¹`createXorpayOrder`æ”¯æŒå¹´ä»˜å‚æ•°
- å¹´ä»˜ä»·æ ¼è®¡ç®—
- è®¢å•åç§°æ ‡è¯†å¹´ä»˜

#### 3. æ”¯ä»˜Actionæ›´æ–°
- `checkoutAction`ï¼šä¼ é€’å¹´ä»˜å‚æ•°
- `xorpayCheckoutAction`ï¼šä¼ é€’å¹´ä»˜å‚æ•°

## ä»·æ ¼ç¤ºä¾‹

### Stripe (USD)
- **æœˆä»˜**ï¼š$4.99/æœˆ
- **å¹´ä»˜**ï¼š$47.90/å¹´ï¼ˆåŸä»·$59.88ï¼ŒèŠ‚çœ$11.98ï¼‰
- **æœˆå‡**ï¼š$3.99/æœˆ

### Xorpay (CNY)
- **æœˆä»˜**ï¼šÂ¥34.90/æœˆ
- **å¹´ä»˜**ï¼šÂ¥335.04/å¹´ï¼ˆåŸä»·Â¥418.80ï¼ŒèŠ‚çœÂ¥83.76ï¼‰
- **æœˆå‡**ï¼šÂ¥27.92/æœˆ

## ä½¿ç”¨æ–¹æ³•

### ç”¨æˆ·æ“ä½œæµç¨‹
1. è®¿é—®å®šä»·é¡µé¢
2. é€‰æ‹©Premiumè®¡åˆ’
3. å¼€å¯"Annual Subscription"å¼€å…³
4. æŸ¥çœ‹å¹´ä»˜ä»·æ ¼å’ŒèŠ‚çœé‡‘é¢
5. é€‰æ‹©æ”¯ä»˜æ–¹å¼ï¼ˆStripeæˆ–å¾®ä¿¡æ”¯ä»˜ï¼‰
6. å®Œæˆæ”¯ä»˜

### å¼€å‘è€…æµ‹è¯•
```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# è®¿é—®å®šä»·é¡µé¢
http://localhost:3000/pricing

# æµ‹è¯•å¹´ä»˜åŠŸèƒ½
1. é€‰æ‹©Premiumè®¡åˆ’
2. åˆ‡æ¢å¹´ä»˜å¼€å…³
3. éªŒè¯ä»·æ ¼è®¡ç®—
4. æµ‹è¯•æ”¯ä»˜æµç¨‹
```

## æŠ€æœ¯å®ç°

### æ–‡ä»¶ä¿®æ”¹åˆ—è¡¨
- `src/app/[locale]/(dashboard)/pricing/payment-method-selector.tsx`
- `lib/payments/actions.ts`
- `lib/payments/stripe.ts`
- `lib/payments/xorpay-actions.ts`
- `lib/payments/xorpay.ts`
- `components/ui/switch.tsx` (æ–°å¢)

### å…³é”®ä»£ç ç‰‡æ®µ

#### Switchç»„ä»¶ä½¿ç”¨
```tsx
<Switch
  id={`annual-${plan.name}`}
  checked={isAnnualBilling}
  onCheckedChange={setIsAnnualBilling}
  className="data-[state=checked]:bg-orange-600"
/>
```

#### å¹´ä»˜ä»·æ ¼æ˜¾ç¤º
```tsx
{isAnnual ? (
  <div className="space-y-1">
    <p className="text-2xl font-medium text-gray-900">
      {currency}{price.toFixed(2)} <span className="text-lg font-normal text-gray-600">/ Year</span>
    </p>
    <p className="text-sm text-gray-600">
      {currency}{monthlyEquivalent?.toFixed(2)}/Month
    </p>
  </div>
) : (
  // æœˆä»˜æ˜¾ç¤ºé€»è¾‘
)}
```

## æµ‹è¯•åœºæ™¯

### åŠŸèƒ½æµ‹è¯•
- [ ] å¹´ä»˜å¼€å…³æ­£å¸¸å·¥ä½œ
- [ ] ä»·æ ¼è®¡ç®—å‡†ç¡®
- [ ] èŠ‚çœé‡‘é¢æ˜¾ç¤ºæ­£ç¡®
- [ ] Stripeå¹´ä»˜æ”¯ä»˜æˆåŠŸ
- [ ] Xorpayå¹´ä»˜æ”¯ä»˜æˆåŠŸ

### UIæµ‹è¯•
- [ ] å¹´ä»˜é€‰é¡¹ä»…åœ¨Premiumè®¡åˆ’æ˜¾ç¤º
- [ ] Switchç»„ä»¶æ ·å¼æ­£ç¡®
- [ ] ä»·æ ¼æ ¼å¼åŒ–æ­£ç¡®
- [ ] å“åº”å¼è®¾è®¡æ­£å¸¸

### è¾¹ç•Œæµ‹è¯•
- [ ] éPremiumè®¡åˆ’ä¸æ˜¾ç¤ºå¹´ä»˜é€‰é¡¹
- [ ] ä¿ƒé”€æ´»åŠ¨ä¸å¹´ä»˜æŠ˜æ‰£å…¼å®¹
- [ ] æ”¯ä»˜å¤±è´¥å¤„ç†
- [ ] æ•°æ®éªŒè¯

## åç»­ä¼˜åŒ–

### å¯èƒ½çš„æ”¹è¿›
1. **A/Bæµ‹è¯•**ï¼šæµ‹è¯•ä¸åŒæŠ˜æ‰£æ¯”ä¾‹çš„è½¬åŒ–ç‡
2. **åŠ¨ç”»æ•ˆæœ**ï¼šæ·»åŠ ä»·æ ¼åˆ‡æ¢åŠ¨ç”»
3. **æ›´å¤šè®¡åˆ’**ï¼šä¸ºå…¶ä»–è®¡åˆ’æ·»åŠ å¹´ä»˜é€‰é¡¹
4. **å­£ä»˜é€‰é¡¹**ï¼šæ·»åŠ å­£ä»˜é€‰é¡¹
5. **è‡ªå®šä¹‰æŠ˜æ‰£**ï¼šæ”¯æŒç®¡ç†å‘˜è®¾ç½®æŠ˜æ‰£æ¯”ä¾‹

### ç›‘æ§æŒ‡æ ‡
- å¹´ä»˜è½¬åŒ–ç‡
- å¹³å‡è®¢å•ä»·å€¼
- ç”¨æˆ·ç•™å­˜ç‡
- æ”¯ä»˜æˆåŠŸç‡

---

## å¿«é€ŸéªŒè¯

1. **å¯åŠ¨åº”ç”¨**ï¼š`npm run dev`
2. **è®¿é—®å®šä»·é¡µé¢**ï¼š`/pricing`
3. **æµ‹è¯•å¹´ä»˜åŠŸèƒ½**ï¼š
   - é€‰æ‹©Premiumè®¡åˆ’
   - åˆ‡æ¢å¹´ä»˜å¼€å…³
   - éªŒè¯ä»·æ ¼å˜åŒ–
   - æµ‹è¯•æ”¯ä»˜æµç¨‹

å¹´ä»˜åŠŸèƒ½ç°å·²å®Œå…¨å®ç°å¹¶å¯ä»¥ä½¿ç”¨ï¼ğŸ‰
